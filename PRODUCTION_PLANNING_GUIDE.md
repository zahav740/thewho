# Руководство по планированию производства

## Основные принципы планирования

### Последовательность операций по заказу
- В рамках одного заказа операции выполняются **строго последовательно**
- Операция 20 может начаться только после завершения операции 10
- В течение одного дня могут выполняться разные заказы на разных станках

### Автоматическое планирование

#### Базовое планирование
- Сортирует заказы по приоритету и дедлайну
- Учитывает совместимость операций и станков
- Автоматически рассчитывает время наладки
- Добавляет буферное время на случай простоев

#### Адаптивное планирование
- Использует фактические данные из смен
- Корректирует время операций на основе истории
- Более точные прогнозы времени выполнения

## Ручное редактирование планирования

### Когда использовать
- Изменение станка для операции
- Корректировка времени начала
- Обновление планового времени
- Отметка о завершении наладки

### Как редактировать операцию

1. **Открытие редактора**
   - В таблице планирования нажмите "Изменить" напротив операции
   - Откроется модальное окно редактирования

2. **Доступные настройки**
   - **Станок**: Выбор из совместимых станков для данного типа операции
   - **Дата и время начала**: Ручная корректировка расписания
   - **Время выполнения**: Корректировка планового времени
   - **Время наладки**: Изменение времени на наладку

3. **Автоматические пересчеты**
   - При изменении даты/времени начала автоматически пересчитывается окончание
   - Зависимые операции того же заказа автоматически сдвигаются
   - Проверяются дедлайны и создаются предупреждения

### Завершение наладки

1. **Когда отмечать**
   - После фактического завершения наладки станка
   - Перед началом основной обработки

2. **Как отметить**
   - В редакторе операции введите фактическое время наладки
   - Нажмите "Наладка выполнена"
   - Статус операции изменится на "В работе"

## Типы станков и совместимость

### Фрезерные станки
- **Doosan Yashana**: 3-axis, 4-axis, общее фрезерование
- **Doosan Hadasha**: 3-axis, 4-axis, общее фрезерование  
- **Doosan 3**: только 3-axis, общее фрезерование
- **Pinnacle Gdola**: только 4-axis, общее фрезерование
- **Mitsubishi**: только 3-axis, общее фрезерование

### Токарные станки
- **Okuma**: токарные операции
- **JonFord**: токарные операции

## Статусы операций

- **Запланировано**: Операция добавлена в план
- **В работе**: Наладка завершена, идет обработка
- **Перенесено**: Операция была перенесена (автоматически или вручную)
- **Завершено**: Операция полностью выполнена

## Управление предупреждениями

### Типы предупреждений
- **Риск дедлайна**: Заказ может не успеть к сроку
- **Отклонение производительности**: Фактические показатели отличаются от плановых
- **Форс-мажор**: Внештатные ситуации (поломка станка, отсутствие оператора)

### Действия с предупреждениями
- Просмотр деталей в разделе "Уведомления"
- Закрытие решенных предупреждений
- Автоматическое создание при изменении плана

## Интеграция с n8n

### Отправка данных планирования
- Кнопка "Отправить в n8n" отправляет полный план
- Включает информацию о заказах, операциях и станках
- Настройка webhook URL в настройках приложения

### Формат данных
```json
{
  "eventType": "production_planning",
  "timestamp": "2025-05-18T...",
  "data": {
    "orders": [...],
    "summary": {
      "totalOrders": 10,
      "totalOperations": 45,
      "planningResults": 45
    }
  }
}
```

## Советы по эффективному планированию

1. **Регулярное обновление**
   - Запускайте планирование после добавления новых заказов
   - Используйте адаптивное планирование для учета фактических данных

2. **Контроль дедлайнов**
   - Следите за предупреждениями о рисках
   - Корректируйте приоритеты заказов при необходимости

3. **Оптимизация станков**
   - Анализируйте загрузку станков в разделе "Аналитика"  
   - Перераспределяйте операции для выравнивания нагрузки

4. **Учет наладки**
   - Группируйте операции одного типа на одном станке
   - Отмечайте фактическое время наладки для улучшения точности планирования
