==========================================
–ò–ù–°–¢–†–£–ö–¶–ò–Ø –ü–û –†–ê–ó–í–ï–†–¢–´–í–ê–ù–ò–Æ –ù–ê KASUF.XYZ
==========================================

üéØ –¶–ï–õ–¨: –†–∞–∑–º–µ—Å—Ç–∏—Ç—å CRM –Ω–∞ https://kasuf.xyz
üìç –ü–û–†–¢–´: Backend 5200, Frontend 5201
üóÑÔ∏è –ë–î: Supabase PostgreSQL

==========================================
–®–ê–ì 1: –õ–û–ö–ê–õ–¨–ù–ê–Ø –ü–û–î–ì–û–¢–û–í–ö–ê
==========================================

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏:
   prepare-for-beget.bat

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç:
- –ü—Ä–æ–≤–µ—Ä–∏—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –ø–æ—Ä—Ç–æ–≤
- –ü–µ—Ä–µ—Å–æ–±–µ—Ä–µ—Ç frontend –∏ backend
- –°–æ–∑–¥–∞—Å—Ç –∞—Ä—Ö–∏–≤—ã —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
- –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç –≤—Å–µ —Ñ–∞–π–ª—ã –≤ kasuf-xyz-deploy/

2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ–ª—É—á–∏–ª–∞—Å—å —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:
   kasuf-xyz-deploy/
   ‚îú‚îÄ‚îÄ frontend/
   ‚îÇ   ‚îú‚îÄ‚îÄ frontend-beget.zip ‚úÖ
   ‚îÇ   ‚îî‚îÄ‚îÄ .env ‚úÖ
   ‚îú‚îÄ‚îÄ backend/
   ‚îÇ   ‚îú‚îÄ‚îÄ backend-beget.zip ‚úÖ
   ‚îÇ   ‚îî‚îÄ‚îÄ .env ‚úÖ
   ‚îú‚îÄ‚îÄ ecosystem.config.js ‚úÖ
   ‚îú‚îÄ‚îÄ kasuf.xyz.nginx.conf ‚úÖ
   ‚îî‚îÄ‚îÄ deploy.sh ‚úÖ

==========================================
–®–ê–ì 2: –ó–ê–ì–†–£–ó–ö–ê –ù–ê BEGET
==========================================

1. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –í–°–Å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ kasuf-xyz-deploy/ 
   –Ω–∞ —Å–µ—Ä–≤–µ—Ä Beget –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é /var/upload/

2. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å:
   /var/upload/
   ‚îú‚îÄ‚îÄ frontend/
   ‚îÇ   ‚îú‚îÄ‚îÄ frontend-beget.zip
   ‚îÇ   ‚îî‚îÄ‚îÄ .env
   ‚îú‚îÄ‚îÄ backend/
   ‚îÇ   ‚îú‚îÄ‚îÄ backend-beget.zip
   ‚îÇ   ‚îî‚îÄ‚îÄ .env
   ‚îú‚îÄ‚îÄ ecosystem.config.js
   ‚îú‚îÄ‚îÄ kasuf.xyz.nginx.conf
   ‚îî‚îÄ‚îÄ deploy.sh

==========================================
–®–ê–ì 3: –ù–ê–°–¢–†–û–ô–ö–ê NGINX
==========================================

1. –í –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Beget:
   "–°–∞–π—Ç—ã" ‚Üí kasuf.xyz ‚Üí "Nginx"

2. –î–æ–±–∞–≤—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏–∑ kasuf.xyz.nginx.conf:

```nginx
# Frontend
location / {
    proxy_pass http://127.0.0.1:5201;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
}

# Backend API
location /api/ {
    proxy_pass http://127.0.0.1:5200/;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
    
    # CORS headers
    add_header Access-Control-Allow-Origin "https://kasuf.xyz" always;
    add_header Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS" always;
    add_header Access-Control-Allow-Headers "Origin, X-Requested-With, Content-Type, Accept, Authorization" always;
    add_header Access-Control-Allow-Credentials "true" always;
}

# Health check
location /health {
    proxy_pass http://127.0.0.1:5200/health;
    proxy_set_header Host $host;
}
```

==========================================
–®–ê–ì 4: –†–ê–ó–í–ï–†–¢–´–í–ê–ù–ò–ï –ù–ê –°–ï–†–í–ï–†–ï
==========================================

1. SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É Beget

2. –ü–µ—Ä–µ—Ö–æ–¥ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é:
   cd /var/upload/

3. –ü—Ä–∞–≤–∞ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ:
   chmod +x deploy.sh

4. –ó–∞–ø—É—Å–∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è:
   ./deploy.sh

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –†–∞—Å–ø–∞–∫—É–µ—Ç –∞—Ä—Ö–∏–≤—ã
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç PM2 –∏ serve
- –°–æ–±–µ—Ä–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ó–∞–ø—É—Å—Ç–∏—Ç –Ω–∞ –ø–æ—Ä—Ç–∞—Ö 5200 –∏ 5201
- –ù–∞—Å—Ç—Ä–æ–∏—Ç –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫

==========================================
–®–ê–ì 5: –ü–†–û–í–ï–†–ö–ê –†–ê–ë–û–¢–´
==========================================

1. –°—Ç–∞—Ç—É—Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π:
   pm2 status

2. –õ–æ–≥–∏:
   pm2 logs
   pm2 logs crm-backend
   pm2 logs crm-frontend

3. –¢–µ—Å—Ç—ã –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏:
   curl http://localhost:5200/health
   curl http://localhost:5201
   curl https://kasuf.xyz/health
   curl https://kasuf.xyz

==========================================
–£–°–¢–†–ê–ù–ï–ù–ò–ï –ü–†–û–ë–õ–ï–ú
==========================================

üîß Backend –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è:
   pm2 logs crm-backend
   cd /var/upload/backend
   npm run build
   pm2 restart crm-backend

üîß Frontend –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
   pm2 logs crm-frontend
   cd /var/upload/frontend
   npm run build
   pm2 restart crm-frontend

üîß CORS –æ—à–∏–±–∫–∏:
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
   - –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ CORS_ORIGIN=https://kasuf.xyz –≤ backend/.env

üîß API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω:
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ backend —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 5200
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Nginx –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ /api/ ‚Üí 5200

üîß –ü–æ–ª–Ω—ã–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫:
   pm2 delete all
   ./deploy.sh

==========================================
–ü–û–õ–ï–ó–ù–´–ï –ö–û–ú–ê–ù–î–´
==========================================

# –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ PM2
pm2 status           # —Å—Ç–∞—Ç—É—Å –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
pm2 logs             # –≤—Å–µ –ª–æ–≥–∏
pm2 restart all      # –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö
pm2 stop all         # –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö
pm2 delete all       # —É–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
pm2 monit            # –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
htop                 # —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
curl https://kasuf.xyz/health
curl https://kasuf.xyz/api/auth/health
curl https://kasuf.xyz

# –õ–æ–≥–∏ Nginx
tail -f /var/log/nginx/access.log
tail -f /var/log/nginx/error.log

==========================================
–ê–†–•–ò–¢–ï–ö–¢–£–†–ê –ü–û–°–õ–ï –†–ê–ó–í–ï–†–¢–´–í–ê–ù–ò–Ø
==========================================

Internet
    ‚Üì
https://kasuf.xyz (SSL –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
    ‚Üì
Nginx (–ø–æ—Ä—Ç—ã 80/443)
    ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Frontend      ‚îÇ    Backend      ‚îÇ
‚îÇ   (port 5201)   ‚îÇ   (port 5200)   ‚îÇ
‚îÇ   React SPA     ‚îÇ   NestJS API    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
          ‚Üì
    Supabase PostgreSQL
   (aws-0-eu-central-1)

==========================================
–ì–û–¢–û–í–û!
==========================================

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤:
üåê –°–∞–π—Ç: https://kasuf.xyz
üì° API: https://kasuf.xyz/api
üíì Health: https://kasuf.xyz/health

–í–∞—à CRM –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ! üöÄ

==========================================
–ö–û–ù–¢–ê–ö–¢–´
==========================================

–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ pm2 status –∏ pm2 logs
2. –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ .env —Ñ–∞–π–ª—ã –≤ backend –∏ frontend
4. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ Supabase –¥–æ—Å—Ç—É–ø–Ω–∞