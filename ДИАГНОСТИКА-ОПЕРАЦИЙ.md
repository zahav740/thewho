# –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã "–û–ø–µ—Ä–∞—Ü–∏—è –Ω–µ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è"

## üîç –ü–æ—à–∞–≥–æ–≤–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞
–û—Ç–∫—Ä–æ–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ (F12) –∏ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª—å:
- –ï—Å—Ç—å –ª–∏ –æ—à–∏–±–∫–∏ JavaScript?
- –í—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ª–∏ API –∑–∞–ø—Ä–æ—Å—ã?
- –ö–∞–∫–∏–µ –æ—Ç–≤–µ—Ç—ã –ø—Ä–∏—Ö–æ–¥—è—Ç –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞?

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Network (–°–µ—Ç—å)
–í –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ –≤–æ –≤–∫–ª–∞–¥–∫–µ Network:
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ª–∏ –∑–∞–ø—Ä–æ—Å `/api/planning/assign-operation`?
- –ö–∞–∫–æ–π —Å—Ç–∞—Ç—É—Å –æ—Ç–≤–µ—Ç–∞ (200, 400, 500)?
- –ß—Ç–æ —Å–æ–¥–µ—Ä–∂–∏—Ç –æ—Ç–≤–µ—Ç?

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

#### 3.1 –ë—ç–∫–µ–Ω–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç?
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –±—ç–∫–µ–Ω–¥ –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 3001
curl http://localhost:3001/api/health
```

#### 3.2 –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∞?
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL
psql -h localhost -U postgres -d thewho -c "SELECT NOW();"
```

#### 3.3 –ï—Å—Ç—å –ª–∏ –¥–∞–Ω–Ω—ã–µ –≤ –ë–î?
```sql
-- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
SELECT id, "operationNumber", status, "assignedMachine" FROM operations LIMIT 5;

-- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞–Ω–∫–∏
SELECT id, "machineName", "isActive", "isOccupied", "currentOperation" FROM machines LIMIT 5;

-- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–º–µ–Ω—ã
SELECT id, "machineId", "operationId", "dayShiftQuantity", "nightShiftQuantity" FROM shift_records ORDER BY "createdAt" DESC LIMIT 5;
```

## üõ†Ô∏è –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞ 1: API endpoint –Ω–µ –Ω–∞–π–¥–µ–Ω (404)
**–°–∏–º–ø—Ç–æ–º—ã:** –í –∫–æ–Ω—Å–æ–ª–∏ –æ—à–∏–±–∫–∞ 404 –Ω–∞ `/api/planning/assign-operation`
**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±—ç–∫–µ–Ω–¥ –∑–∞–ø—É—â–µ–Ω
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –º–æ–¥—É–ª—å planning –ø–æ–¥–∫–ª—é—á–µ–Ω –≤ app.module.ts
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±—ç–∫–µ–Ω–¥

### –ü—Ä–æ–±–ª–µ–º–∞ 2: CORS –æ—à–∏–±–∫–∞
**–°–∏–º–ø—Ç–æ–º—ã:** CORS policy errors –≤ –∫–æ–Ω—Å–æ–ª–∏
**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ CORS –≤ main.ts –±—ç–∫–µ–Ω–¥–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—Ç

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞
**–°–∏–º–ø—Ç–æ–º—ã:** 500 –æ—à–∏–±–∫–∏, connection errors
**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ .env —Ñ–∞–π–ª —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ë–î

### –ü—Ä–æ–±–ª–µ–º–∞ 4: –û–ø–µ—Ä–∞—Ü–∏—è –Ω–∞–∑–Ω–∞—á–∞–µ—Ç—Å—è, –Ω–æ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
**–°–∏–º–ø—Ç–æ–º—ã:** API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç success, –Ω–æ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –Ω–∏—á–µ–≥–æ –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è
**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ React Query –∫—ç—à –≤ Redux DevTools
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ invalidateQueries –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è—é—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ

## üöÄ –ë—ã—Å—Ç—Ä–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç 1: –ü—Ä—è–º–æ–π API –≤—ã–∑–æ–≤
```bash
# –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞–ø—Ä—è–º—É—é
curl -X POST http://localhost:3001/api/planning/assign-operation \
  -H "Content-Type: application/json" \
  -d '{"operationId": 1, "machineId": 1}'
```

### –¢–µ—Å—Ç 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å—Ç–∞–Ω–∫–æ–≤
```bash
# –ü–æ–ª—É—á–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ —Å—Ç–∞–Ω–∫–æ–≤
curl http://localhost:3001/api/machines
```

### –¢–µ—Å—Ç 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–ø–µ—Ä–∞—Ü–∏–π
```bash
# –ü–æ–ª—É—á–∏—Ç–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ —Ä–∞–±–æ—Ç–µ
curl http://localhost:3001/api/operations/in-progress
```

## üìù –õ–æ–≥–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

### –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–ª—è—Ç—å—Å—è:
```
üéØ –£–õ–£–ß–®–ï–ù–ù–û–ï –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ: PlanningModal render: { visible: true, selectedMachine: "–°—Ç–∞–Ω–æ–∫..." }
üéØ –í—ã–±—Ä–∞–Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏—è –¥–ª—è –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è: { operationId: 123, ... }
‚úÖ –û–ø–µ—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∞: { success: true, ... }
üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø–æ—Å–ª–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–∏ 123 –Ω–∞ —Å—Ç–∞–Ω–æ–∫ 1
```

### –í –ª–æ–≥–∞—Ö –±—ç–∫–µ–Ω–¥–∞ –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–ª—è—Ç—å—Å—è:
```
[ProductionPlanningController] –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ 123 –Ω–∞ —Å—Ç–∞–Ω–æ–∫ 1
[ProductionPlanningController] –û–ø–µ—Ä–∞—Ü–∏—è 1 –Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –Ω–∞ —Å—Ç–∞–Ω–æ–∫ –°—Ç–∞–Ω–æ–∫1
```

## üîß –≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç:

1. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –≤—Å—ë:**
```bash
cd backend && npm run start:dev
cd frontend && npm start
```

2. **–û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à –±—Ä–∞—É–∑–µ—Ä–∞:**
- Ctrl+Shift+R (–ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞)
- –û—á–∏—Å—Ç–∏—Ç–µ Local Storage –∏ Session Storage

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–µ—Ä—Å–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:**
```bash
# –í frontend –ø–∞–ø–∫–µ
npm list @tanstack/react-query
npm list antd
```

4. **–°–±—Ä–æ—Å—å—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö:**
```sql
-- –û—á–∏—Å—Ç–∏—Ç–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è
UPDATE machines SET "isOccupied" = false, "currentOperation" = null;
UPDATE operations SET "assignedMachine" = null, status = 'pending';
```

## üìû –ß—Ç–æ —Å–æ–æ–±—â–∏—Ç—å –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ —Ä–µ—à–∞–µ—Ç—Å—è, —Å–æ–æ–±—â–∏—Ç–µ:

1. **–û—à–∏–±–∫–∏ –∏–∑ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞** (—Å–∫—Ä–∏–Ω—à–æ—Ç/—Ç–µ–∫—Å—Ç)
2. **–û—Ç–≤–µ—Ç –æ—Ç API** `/api/planning/assign-operation` (–∏–∑ Network tab)
3. **–õ–æ–≥–∏ –±—ç–∫–µ–Ω–¥–∞** –ø—Ä–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏
4. **–†–µ–∑—É–ª—å—Ç–∞—Ç SQL –∑–∞–ø—Ä–æ—Å–∞:**
```sql
SELECT m."machineName", m."isOccupied", m."currentOperation", 
       o.id as operation_id, o."operationNumber", o.status
FROM machines m 
LEFT JOIN operations o ON o.id = m."currentOperation"
WHERE m.id = [ID_–°–¢–ê–ù–ö–ê];
```

---

## ‚úÖ –ï—Å–ª–∏ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ:

1. –û–ø–µ—Ä–∞—Ü–∏—è –Ω–∞–∑–Ω–∞—á–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ API
2. –î–∞–Ω–Ω—ã–µ –≤ –ë–î –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è
3. React Query –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –∫—ç—à
4. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–∏–≤–∞—é—Ç—Å—è
5. –û–ø–µ—Ä–∞—Ü–∏—è –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ —Å–µ–∫—Ü–∏–∏ –°–º–µ–Ω—ã

**–í—Ä–µ–º—è –ø–æ–ª–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏: 3-5 —Å–µ–∫—É–Ω–¥**
