@echo off
setlocal enabledelayedexpansion

echo ====================================
echo üéØ –°–ê–ú–û–ï –°–¢–ê–ë–ò–õ–¨–ù–û–ï –†–ï–®–ï–ù–ò–ï
echo ====================================
echo –ó–∞–ø—É—Å–∫–∞–µ–º –Ω–∞–¥–µ–∂–Ω—ã–π –∏–º–ø–æ—Ä—Ç Excel —Ñ–∞–π–ª–æ–≤
echo.

echo ‚úÖ –ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê –≠–¢–û–ì–û –†–ï–®–ï–ù–ò–Ø:
echo - –†–∞–±–æ—Ç–∞–µ—Ç –≤ –ª—é–±–æ–º –±—Ä–∞—É–∑–µ—Ä–µ –±–µ–∑ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ü–û
echo - –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç drag & drop Excel —Ñ–∞–π–ª–æ–≤  
echo - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–∞—Ä—Å–∏—Ç –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–∞–Ω–Ω—ã–µ
echo - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–µ–≤—å—é –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π
echo - –ó–∞–≥—Ä—É–∂–∞–µ—Ç —á–µ—Ä–µ–∑ —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ API endpoints
echo - –ö—Ä–∞—Å–∏–≤—ã–π —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
echo - –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –æ—à–∏–±–æ–∫
echo.

echo üîß –ß–¢–û –ù–£–ñ–ù–û:
echo 1. Backend –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ –ø–æ—Ä—Ç—É 5100
echo 2. –õ—é–±–æ–π –±—Ä–∞—É–∑–µ—Ä (Chrome, Firefox, Edge)
echo.

echo üöÄ –ü—Ä–æ–≤–µ—Ä—è–µ–º backend...
curl -s http://localhost:5100/api/health >nul 2>&1
if !errorlevel!==0 (
    echo ‚úÖ Backend —Ä–∞–±–æ—Ç–∞–µ—Ç
) else (
    echo ‚ùå Backend –Ω–µ –∑–∞–ø—É—â–µ–Ω
    echo üí° –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–Ω–∞—á–∞–ª–∞ backend:
    echo    cd backend
    echo    npm run start
    echo.
    set /p continue="–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –≤ –ª—é–±–æ–º —Å–ª—É—á–∞–µ? (y/N): "
    if /i "!continue!" neq "y" exit /b 1
)

echo.
echo üåê –û—Ç–∫—Ä—ã–≤–∞–µ–º —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –∏–º–ø–æ—Ä—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ...

REM –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø—É—Ç—å –∫ HTML —Ñ–∞–π–ª—É
set "html_file=%~dp0–°–¢–ê–ë–ò–õ–¨–ù–´–ô-–ò–ú–ü–û–†–¢-EXCEL.html"

REM –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞
if not exist "!html_file!" (
    echo ‚ùå –§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω: !html_file!
    pause
    exit /b 1
)

REM –û—Ç–∫—Ä—ã–≤–∞–µ–º –≤ –±—Ä–∞—É–∑–µ—Ä–µ
start "–°—Ç–∞–±–∏–ª—å–Ω—ã–π –∏–º–ø–æ—Ä—Ç Excel" "!html_file!"

echo ‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –æ—Ç–∫—Ä—ã—Ç–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ!
echo.

echo üìã –ò–ù–°–¢–†–£–ö–¶–ò–Ø –ü–û –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ:
echo.
echo 1. üìÅ –ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –≤–∞—à Excel —Ñ–∞–π–ª –≤ –æ–∫–Ω–æ –±—Ä–∞—É–∑–µ—Ä–∞
echo    –ò–õ–ò —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ Excel –∏ –≤—Å—Ç–∞–≤—å—Ç–µ –≤ –ø–æ–ª–µ
echo.
echo 2. üîç –ù–∞–∂–º–∏—Ç–µ "–û–±—Ä–∞–±–æ—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–µ" 
echo    –°–∏—Å—Ç–µ–º–∞ –ø–æ–∫–∞–∂–µ—Ç –ø—Ä–µ–≤—å—é –≤–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö
echo.
echo 3. üóëÔ∏è (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ù–∞–∂–º–∏—Ç–µ "–û—á–∏—Å—Ç–∏—Ç—å –±–∞–∑—É"
echo    –£–¥–∞–ª–∏—Ç —Å—Ç–∞—Ä—ã–µ –∑–∞–∫–∞–∑—ã (TH1K4108A, C6HP0021A, G63828A)
echo.
echo 4. üöÄ –ù–∞–∂–º–∏—Ç–µ "–ó–∞–≥—Ä—É–∑–∏—Ç—å –≤ –ë–î"
echo    –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∑—è—Ç—Å—è —á–µ—Ä–µ–∑ —Å—Ç–∞–±–∏–ª—å–Ω—ã–π API
echo.
echo 5. üéâ –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:5101/database
echo    –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã
echo.

echo ‚ö° –ü–û–ß–ï–ú–£ –≠–¢–û –†–ê–ë–û–¢–ê–ï–¢:
echo - –û–±—Ö–æ–¥–∏—Ç –ø—Ä–æ–±–ª–µ–º–Ω—É—é –≤–µ–±-–∑–∞–≥—Ä—É–∑–∫—É —Ñ–∞–π–ª–æ–≤
echo - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É SheetJS
echo - –ó–∞–≥—Ä—É–∂–∞–µ—Ç —á–µ—Ä–µ–∑ —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ API endpoints
echo - –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ
echo.

echo üîó –ü–û–õ–ï–ó–ù–´–ï –°–°–´–õ–ö–ò:
echo - –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö: !html_file!
echo - –ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–∫–∞–∑–æ–≤: http://localhost:5101/database
echo - API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: http://localhost:5100/api/docs
echo - –ü—Ä–æ–≤–µ—Ä–∫–∞ API: http://localhost:5100/api/health
echo.

echo ================================
echo ‚úÖ –ì–û–¢–û–í–û –ö –†–ê–ë–û–¢–ï!
echo ================================
echo.
echo –ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –ø—Ä–æ–±–ª–µ–º—ã:
echo 1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ backend –∑–∞–ø—É—â–µ–Ω
echo 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç Excel —Ñ–∞–π–ª–∞
echo 3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤—Ä—É—á–Ω—É—é
echo.

pause
