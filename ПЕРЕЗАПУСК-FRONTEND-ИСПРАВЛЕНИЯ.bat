@echo off
echo ========================================
echo –ü–ï–†–ï–ó–ê–ü–£–°–ö FRONTEND –° –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø–ú–ò
echo ========================================

echo [1/3] –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º frontend –ø—Ä–æ—Ü–µ—Å—Å—ã...
tasklist | findstr "3000\|5101" >nul 2>&1
if %errorlevel% == 0 (
    echo ‚ö†Ô∏è –ù–∞–π–¥–µ–Ω—ã –ø—Ä–æ—Ü–µ—Å—Å—ã –Ω–∞ –ø–æ—Ä—Ç–∞—Ö 3000/5101, –∑–∞–≤–µ—Ä—à–∞–µ–º...
    for /f "tokens=5" %%i in ('netstat -ano ^| findstr ":3000.*LISTENING"') do taskkill /f /pid %%i 2>nul
    for /f "tokens=5" %%i in ('netstat -ano ^| findstr ":5101.*LISTENING"') do taskkill /f /pid %%i 2>nul
    timeout /t 3 /nobreak >nul
) else (
    echo ‚úÖ –ü–æ—Ä—Ç—ã —Å–≤–æ–±–æ–¥–Ω—ã
)

echo.
echo [2/3] –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é frontend...
cd /d "%~dp0\frontend"
if not exist package.json (
    echo ‚ùå Frontend –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!
    pause
    exit /b 1
)
echo ‚úÖ –í –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ frontend

echo.
echo [3/3] –ó–∞–ø—É—Å–∫–∞–µ–º frontend —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏ TypeScript...
echo.
echo üîß –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –í –≠–¢–û–ô –í–ï–†–°–ò–ò:
echo   ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –æ—à–∏–±–∫–∏ TypeScript –≤ ExcelUploaderWithSettings
echo   ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –æ–ø—Ü–∏–∏ "–í—ã–±–æ—Ä–æ—á–Ω–æ" –∏ "–í—Å–µ" –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤
echo   ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è ImportSettings
echo   ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Å–ª–∏—è–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Å defaultImportSettings
echo.
echo üöÄ –ó–∞–ø—É—Å–∫–∞–µ–º –Ω–∞ –ø–æ—Ä—Ç—É 5101...

set PORT=5101
start "üåê Frontend (TypeScript Fixed)" cmd /k "title Frontend 5101 - TS Fixed && echo FRONTEND STARTING WITH TYPESCRIPT FIXES... && npm start"

echo.
echo ========================================
echo FRONTEND –ó–ê–ü–£–°–ö–ê–ï–¢–°–Ø –° –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø–ú–ò!
echo ========================================
echo üåê URL: http://localhost:5101
echo üìã –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
echo   - –ö–Ω–æ–ø–∫–∞ "–í—ã–±–æ—Ä–æ—á–Ω–æ" - –ø–æ–∫–∞–∑–∞—Ç—å –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑—ã
echo   - –ö–Ω–æ–ø–∫–∞ "–í—Å–µ" - –ø–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –∑–∞–∫–∞–∑—ã –∏–∑ —Ñ–∞–π–ª–∞
echo   - –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Å—á–µ—Ç—á–∏–∫–∏ –∑–∞–∫–∞–∑–æ–≤
echo   - –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã —Ä–µ–∂–∏–º–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
echo ========================================

timeout /t 5 /nobreak >nul

echo –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–ø—É—Å–∫...
timeout /t 10 /nobreak >nul

curl -s http://localhost:5101 >nul 2>&1
if %errorlevel% == 0 (
    echo ‚úÖ Frontend —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 5101!
    echo üéØ –ì–æ—Ç–æ–≤ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –Ω–æ–≤—ã—Ö –æ–ø—Ü–∏–π
) else (
    echo ‚ö†Ô∏è Frontend –µ—â–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è, –ø–æ–¥–æ–∂–¥–∏—Ç–µ –Ω–µ–º–Ω–æ–≥–æ...
)

echo.
echo ‚ú® –ì–æ—Ç–æ–≤–æ! –ú–æ–∂–µ—Ç–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–µ –æ–ø—Ü–∏–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤
pause
