@echo off
chcp 65001
echo.
echo ===============================================
echo üîß –≠–ö–°–¢–†–ï–ù–ù–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –û–®–ò–ë–ö–ò 500
echo ===============================================
echo.

echo üìã –≠–¢–ê–ü 1: –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤
echo.

echo –ü—Ä–∏–º–µ–Ω—è–µ–º SQL —Å–∫—Ä–∏–ø—Ç –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö...
psql -h localhost -p 5432 -U postgres -d thewho -f "–°–û–ó–î–ê–¢–¨-–¢–ê–ë–õ–ò–¶–£-–û–ü–ï–†–ê–¢–û–†–û–í.sql"

if %ERRORLEVEL% EQU 0 (
  echo ‚úÖ –¢–∞–±–ª–∏—Ü–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ —Å–æ–∑–¥–∞–Ω–∞/–æ–±–Ω–æ–≤–ª–µ–Ω–∞
) else (
  echo ‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ç–∞–±–ª–∏—Ü—ã
  echo –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
  echo - PostgreSQL –∑–∞–ø—É—â–µ–Ω
  echo - –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö 'thewho' —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
  echo - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å postgres –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
  pause
  exit /b 1
)

echo.
echo üìã –≠–¢–ê–ü 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∞–±–ª–∏—Ü—ã
echo.

psql -h localhost -p 5432 -U postgres -d thewho -c "SELECT COUNT(*) as operator_count FROM operators;"

echo.
echo üìã –≠–¢–ê–ü 3: –ó–∞–ø—É—Å–∫ Backend –Ω–∞ –ø–æ—Ä—Ç—É 5100
echo.

echo üöÄ –ó–∞–ø—É—Å–∫–∞–µ–º Backend...
cd backend

echo –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã...
taskkill /f /im node.exe 2>nul

echo –ó–∞–ø—É—Å–∫–∞–µ–º –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—Ç—É...
set PORT=5100
npm run start:prod

pause
